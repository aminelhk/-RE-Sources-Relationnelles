{"ast":null,"code":"import { assert } from \"tsafe/assert\";\nimport { createStatefulObservable, useRerenderOnChange } from \"../tools/StatefulObservable\";\nimport { useConstCallback } from \"../tools/powerhooks/useConstCallback\";\nimport { fr } from \"../fr\";\nimport { data_fr_scheme, data_fr_theme, rootColorSchemeStyleTagId } from \"./constants\";\nconst $clientSideIsDark = createStatefulObservable(() => {\n  if (typeof process === \"object\" && process.env.JEST_WORKER_ID !== undefined) {\n    return false;\n  }\n  throw new Error([\"react-dsfr not initialized.\", \"Refer to the documentation for setup instructions\", \"If it used to work but after an update you're getting this error\", \"it usually means that you have multiple copies of @codegouvfr/react-dsfr in your node_modules\", \"@codegouvfr/react-dsfr is a singleton, try removing your lock file and node_module.\"].join(\" \"));\n});\nconst $isAfterFirstEffect = createStatefulObservable(() => false);\nexport const useIsDarkClientSide = () => {\n  useRerenderOnChange($clientSideIsDark);\n  useRerenderOnChange($isAfterFirstEffect);\n  const isDark = $isAfterFirstEffect.current ? $clientSideIsDark.current : ssrWasPerformedWithIsDark;\n  const setIsDark = useConstCallback(newIsDarkOrDeduceNewIsDarkFromCurrentIsDark => {\n    const data_fr_js_value = document.documentElement.getAttribute(\"data-fr-js\");\n    const newColorScheme = (() => {\n      switch (typeof newIsDarkOrDeduceNewIsDarkFromCurrentIsDark === \"function\" ? newIsDarkOrDeduceNewIsDarkFromCurrentIsDark(isDark) : newIsDarkOrDeduceNewIsDarkFromCurrentIsDark) {\n        case \"system\":\n          return typeof window.matchMedia === \"function\" && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n        case true:\n          return \"dark\";\n        case false:\n          return \"light\";\n      }\n    })();\n    document.documentElement.setAttribute(data_fr_scheme, newColorScheme);\n    if (data_fr_js_value !== \"true\") {\n      //NOTE: DSFR not started yet.\n      document.documentElement.setAttribute(data_fr_theme, newColorScheme);\n      localStorage.setItem(\"scheme\", newColorScheme);\n    }\n  });\n  return {\n    isDark,\n    setIsDark\n  };\n};\nlet ssrWasPerformedWithIsDark;\nfunction getCurrentIsDarkFromHtmlAttribute() {\n  const colorSchemeFromHtmlAttribute = document.documentElement.getAttribute(data_fr_theme);\n  switch (colorSchemeFromHtmlAttribute) {\n    case null:\n      return undefined;\n    case \"light\":\n      return false;\n    case \"dark\":\n      return true;\n  }\n  assert(false, `Unrecognized ${data_fr_theme} attribute value: ${colorSchemeFromHtmlAttribute}`);\n}\nexport function startClientSideIsDarkLogic(params) {\n  const {\n    doPersistDarkModePreferenceWithCookie,\n    registerEffectAction,\n    colorSchemeExplicitlyProvidedAsParameter,\n    doCheckNonce = false,\n    trustedTypesPolicyName\n  } = params;\n  const {\n    clientSideIsDark,\n    ssrWasPerformedWithIsDark: ssrWasPerformedWithIsDark_\n  } = (() => {\n    var _a, _b, _c;\n    const isDarkFromHtmlAttribute = getCurrentIsDarkFromHtmlAttribute();\n    if (isDarkFromHtmlAttribute !== undefined) {\n      return {\n        \"clientSideIsDark\": isDarkFromHtmlAttribute,\n        \"ssrWasPerformedWithIsDark\": (_a = window.ssrWasPerformedWithIsDark) !== null && _a !== void 0 ? _a : isDarkFromHtmlAttribute\n      };\n    }\n    const isDarkExplicitlyProvidedAsParameter = (() => {\n      if (colorSchemeExplicitlyProvidedAsParameter === \"system\") {\n        return undefined;\n      }\n      switch (colorSchemeExplicitlyProvidedAsParameter) {\n        case \"dark\":\n          return true;\n        case \"light\":\n          return false;\n      }\n    })();\n    const isDarkFromLocalStorage = (() => {\n      const colorSchemeReadFromLocalStorage = localStorage.getItem(\"scheme\");\n      if (colorSchemeReadFromLocalStorage === null) {\n        return undefined;\n      }\n      if (colorSchemeReadFromLocalStorage === \"system\") {\n        return undefined;\n      }\n      switch (colorSchemeReadFromLocalStorage) {\n        case \"dark\":\n          return true;\n        case \"light\":\n          return false;\n      }\n    })();\n    const isDarkFromOsPreference = (() => {\n      if (!window.matchMedia) {\n        return undefined;\n      }\n      return window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n    })();\n    const isDarkFallback = false;\n    return {\n      \"ssrWasPerformedWithIsDark\": isDarkExplicitlyProvidedAsParameter !== null && isDarkExplicitlyProvidedAsParameter !== void 0 ? isDarkExplicitlyProvidedAsParameter : isDarkFallback,\n      \"clientSideIsDark\": (_c = (_b = isDarkFromLocalStorage !== null && isDarkFromLocalStorage !== void 0 ? isDarkFromLocalStorage : isDarkExplicitlyProvidedAsParameter) !== null && _b !== void 0 ? _b : isDarkFromOsPreference) !== null && _c !== void 0 ? _c : isDarkFallback\n    };\n  })();\n  ssrWasPerformedWithIsDark = ssrWasPerformedWithIsDark_;\n  const trustedTypes = window.trustedTypes;\n  const sanitizer = typeof trustedTypes !== \"undefined\" ? trustedTypes.createPolicy(trustedTypesPolicyName, {\n    createHTML: s => s\n  }) : {\n    createHTML: s => s\n  };\n  $clientSideIsDark.current = clientSideIsDark;\n  [data_fr_scheme, data_fr_theme].forEach(attr => document.documentElement.setAttribute(attr, clientSideIsDark ? \"dark\" : \"light\"));\n  new MutationObserver(() => {\n    const isDarkFromHtmlAttribute = getCurrentIsDarkFromHtmlAttribute();\n    assert(isDarkFromHtmlAttribute !== undefined);\n    $clientSideIsDark.current = isDarkFromHtmlAttribute;\n  }).observe(document.documentElement, {\n    \"attributes\": true,\n    \"attributeFilter\": [data_fr_theme]\n  });\n  {\n    const setColorSchemeCookie = isDark => {\n      if (!doPersistDarkModePreferenceWithCookie) {\n        return;\n      }\n      const colorScheme = isDark ? \"dark\" : \"light\";\n      let newCookie = `${data_fr_theme}=${colorScheme};path=/;max-age=31536000;SameSite=Strict`;\n      set_domain: {\n        const {\n          hostname\n        } = window.location;\n        //We do not set the domain if we are on localhost or an ip\n        if (/(^localhost$)|(^((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}$)/.test(hostname)) {\n          break set_domain;\n        }\n        newCookie += `;domain=${hostname}`;\n      }\n      document.cookie = newCookie;\n    };\n    setColorSchemeCookie($clientSideIsDark.current);\n    $clientSideIsDark.subscribe(setColorSchemeCookie);\n  }\n  {\n    const setRootColorScheme = isDark => {\n      var _a;\n      const nonce = window.ssrNonce;\n      if (doCheckNonce && !nonce) {\n        return;\n      }\n      (_a = document.getElementById(rootColorSchemeStyleTagId)) === null || _a === void 0 ? void 0 : _a.remove();\n      const element = document.createElement(\"style\");\n      element.id = rootColorSchemeStyleTagId;\n      if (nonce) {\n        element.setAttribute(\"nonce\", nonce);\n      }\n      element.innerHTML = sanitizer.createHTML(`:root { color-scheme: ${isDark ? \"dark\" : \"light\"}; }`);\n      document.head.appendChild(element);\n    };\n    setRootColorScheme($clientSideIsDark.current);\n    $clientSideIsDark.subscribe(setRootColorScheme);\n  }\n  {\n    const setThemeColor = isDark => {\n      var _a;\n      const name = \"theme-color\";\n      (_a = document.querySelector(`meta[name=${name}]`)) === null || _a === void 0 ? void 0 : _a.remove();\n      const element = document.createElement(\"meta\");\n      element.name = name;\n      element.content = fr.colors.getHex({\n        isDark\n      }).decisions.background.default.grey.default;\n      document.head.appendChild(element);\n    };\n    setThemeColor($clientSideIsDark.current);\n    $clientSideIsDark.subscribe(setThemeColor);\n  }\n  registerEffectAction(() => $isAfterFirstEffect.current = true);\n}","map":{"version":3,"names":["assert","createStatefulObservable","useRerenderOnChange","useConstCallback","fr","data_fr_scheme","data_fr_theme","rootColorSchemeStyleTagId","$clientSideIsDark","process","env","JEST_WORKER_ID","undefined","Error","join","$isAfterFirstEffect","useIsDarkClientSide","isDark","current","ssrWasPerformedWithIsDark","setIsDark","newIsDarkOrDeduceNewIsDarkFromCurrentIsDark","data_fr_js_value","document","documentElement","getAttribute","newColorScheme","window","matchMedia","matches","setAttribute","localStorage","setItem","getCurrentIsDarkFromHtmlAttribute","colorSchemeFromHtmlAttribute","startClientSideIsDarkLogic","params","doPersistDarkModePreferenceWithCookie","registerEffectAction","colorSchemeExplicitlyProvidedAsParameter","doCheckNonce","trustedTypesPolicyName","clientSideIsDark","ssrWasPerformedWithIsDark_","isDarkFromHtmlAttribute","_a","isDarkExplicitlyProvidedAsParameter","isDarkFromLocalStorage","colorSchemeReadFromLocalStorage","getItem","isDarkFromOsPreference","isDarkFallback","_c","_b","trustedTypes","sanitizer","createPolicy","createHTML","s","forEach","attr","MutationObserver","observe","setColorSchemeCookie","colorScheme","newCookie","set_domain","hostname","location","test","cookie","subscribe","setRootColorScheme","nonce","ssrNonce","getElementById","remove","element","createElement","id","innerHTML","head","appendChild","setThemeColor","name","querySelector","content","colors","getHex","decisions","background","default","grey"],"sources":["C:\\Users\\alban\\node_modules\\@codegouvfr\\react-dsfr\\src\\useIsDark\\client.ts"],"sourcesContent":["import { assert } from \"tsafe/assert\";\nimport { createStatefulObservable, useRerenderOnChange } from \"../tools/StatefulObservable\";\nimport { useConstCallback } from \"../tools/powerhooks/useConstCallback\";\nimport { fr } from \"../fr\";\nimport { data_fr_scheme, data_fr_theme, rootColorSchemeStyleTagId } from \"./constants\";\n\nexport type ColorScheme = \"light\" | \"dark\";\n\nconst $clientSideIsDark = createStatefulObservable<boolean>(() => {\n    if (typeof process === \"object\" && process.env.JEST_WORKER_ID !== undefined) {\n        return false;\n    }\n\n    throw new Error(\n        [\n            \"react-dsfr not initialized.\",\n            \"Refer to the documentation for setup instructions\",\n            \"If it used to work but after an update you're getting this error\",\n            \"it usually means that you have multiple copies of @codegouvfr/react-dsfr in your node_modules\",\n            \"@codegouvfr/react-dsfr is a singleton, try removing your lock file and node_module.\"\n        ].join(\" \")\n    );\n});\n\nexport type UseIsDark = () => {\n    isDark: boolean;\n    setIsDark: (\n        isDark: boolean | \"system\" | ((currentIsDark: boolean) => boolean | \"system\")\n    ) => void;\n};\n\nconst $isAfterFirstEffect = createStatefulObservable(() => false);\n\nexport const useIsDarkClientSide: UseIsDark = () => {\n    useRerenderOnChange($clientSideIsDark);\n    useRerenderOnChange($isAfterFirstEffect);\n\n    const isDark = $isAfterFirstEffect.current\n        ? $clientSideIsDark.current\n        : ssrWasPerformedWithIsDark;\n\n    const setIsDark = useConstCallback<ReturnType<UseIsDark>[\"setIsDark\"]>(\n        newIsDarkOrDeduceNewIsDarkFromCurrentIsDark => {\n            const data_fr_js_value = document.documentElement.getAttribute(\"data-fr-js\");\n\n            const newColorScheme = ((): ColorScheme => {\n                switch (\n                    typeof newIsDarkOrDeduceNewIsDarkFromCurrentIsDark === \"function\"\n                        ? newIsDarkOrDeduceNewIsDarkFromCurrentIsDark(isDark)\n                        : newIsDarkOrDeduceNewIsDarkFromCurrentIsDark\n                ) {\n                    case \"system\":\n                        return typeof window.matchMedia === \"function\" &&\n                            window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n                            ? \"dark\"\n                            : \"light\";\n                    case true:\n                        return \"dark\";\n                    case false:\n                        return \"light\";\n                }\n            })();\n\n            document.documentElement.setAttribute(data_fr_scheme, newColorScheme);\n\n            if (data_fr_js_value !== \"true\") {\n                //NOTE: DSFR not started yet.\n                document.documentElement.setAttribute(data_fr_theme, newColorScheme);\n                localStorage.setItem(\"scheme\", newColorScheme);\n            }\n        }\n    );\n\n    return {\n        isDark,\n        setIsDark\n    };\n};\n\nlet ssrWasPerformedWithIsDark: boolean;\n\nfunction getCurrentIsDarkFromHtmlAttribute(): boolean | undefined {\n    const colorSchemeFromHtmlAttribute = document.documentElement.getAttribute(data_fr_theme);\n\n    switch (colorSchemeFromHtmlAttribute) {\n        case null:\n            return undefined;\n        case \"light\":\n            return false;\n        case \"dark\":\n            return true;\n    }\n\n    assert(false, `Unrecognized ${data_fr_theme} attribute value: ${colorSchemeFromHtmlAttribute}`);\n}\n\nexport function startClientSideIsDarkLogic(params: {\n    registerEffectAction: (action: () => void) => void;\n    doPersistDarkModePreferenceWithCookie: boolean;\n    colorSchemeExplicitlyProvidedAsParameter: ColorScheme | \"system\";\n    doCheckNonce: boolean;\n    trustedTypesPolicyName: string;\n}) {\n    const {\n        doPersistDarkModePreferenceWithCookie,\n        registerEffectAction,\n        colorSchemeExplicitlyProvidedAsParameter,\n        doCheckNonce = false,\n        trustedTypesPolicyName\n    } = params;\n\n    const { clientSideIsDark, ssrWasPerformedWithIsDark: ssrWasPerformedWithIsDark_ } = ((): {\n        clientSideIsDark: boolean;\n        ssrWasPerformedWithIsDark: boolean;\n    } => {\n        const isDarkFromHtmlAttribute = getCurrentIsDarkFromHtmlAttribute();\n\n        if (isDarkFromHtmlAttribute !== undefined) {\n            return {\n                \"clientSideIsDark\": isDarkFromHtmlAttribute,\n                \"ssrWasPerformedWithIsDark\":\n                    window.ssrWasPerformedWithIsDark ?? isDarkFromHtmlAttribute\n            };\n        }\n\n        const isDarkExplicitlyProvidedAsParameter = (() => {\n            if (colorSchemeExplicitlyProvidedAsParameter === \"system\") {\n                return undefined;\n            }\n\n            switch (colorSchemeExplicitlyProvidedAsParameter as ColorScheme) {\n                case \"dark\":\n                    return true;\n                case \"light\":\n                    return false;\n            }\n        })();\n\n        const isDarkFromLocalStorage = (() => {\n            const colorSchemeReadFromLocalStorage = localStorage.getItem(\"scheme\");\n\n            if (colorSchemeReadFromLocalStorage === null) {\n                return undefined;\n            }\n\n            if (colorSchemeReadFromLocalStorage === \"system\") {\n                return undefined;\n            }\n\n            switch (colorSchemeReadFromLocalStorage as ColorScheme) {\n                case \"dark\":\n                    return true;\n                case \"light\":\n                    return false;\n            }\n        })();\n\n        const isDarkFromOsPreference = (() => {\n            if (!window.matchMedia) {\n                return undefined;\n            }\n\n            return window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n        })();\n\n        const isDarkFallback = false;\n\n        return {\n            \"ssrWasPerformedWithIsDark\": isDarkExplicitlyProvidedAsParameter ?? isDarkFallback,\n            \"clientSideIsDark\":\n                isDarkFromLocalStorage ??\n                isDarkExplicitlyProvidedAsParameter ??\n                isDarkFromOsPreference ??\n                isDarkFallback\n        };\n    })();\n\n    ssrWasPerformedWithIsDark = ssrWasPerformedWithIsDark_;\n\n    const trustedTypes = (window as any).trustedTypes;\n    const sanitizer =\n        typeof trustedTypes !== \"undefined\"\n            ? trustedTypes.createPolicy(trustedTypesPolicyName, { createHTML: (s: string) => s })\n            : {\n                  createHTML: (s: string) => s\n              };\n\n    $clientSideIsDark.current = clientSideIsDark;\n\n    [data_fr_scheme, data_fr_theme].forEach(attr =>\n        document.documentElement.setAttribute(attr, clientSideIsDark ? \"dark\" : \"light\")\n    );\n\n    new MutationObserver(() => {\n        const isDarkFromHtmlAttribute = getCurrentIsDarkFromHtmlAttribute();\n\n        assert(isDarkFromHtmlAttribute !== undefined);\n\n        $clientSideIsDark.current = isDarkFromHtmlAttribute;\n    }).observe(document.documentElement, {\n        \"attributes\": true,\n        \"attributeFilter\": [data_fr_theme]\n    });\n\n    {\n        const setColorSchemeCookie = (isDark: boolean) => {\n            if (!doPersistDarkModePreferenceWithCookie) {\n                return;\n            }\n\n            const colorScheme: ColorScheme = isDark ? \"dark\" : \"light\";\n\n            let newCookie = `${data_fr_theme}=${colorScheme};path=/;max-age=31536000;SameSite=Strict`;\n\n            set_domain: {\n                const { hostname } = window.location;\n\n                //We do not set the domain if we are on localhost or an ip\n                if (/(^localhost$)|(^((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}$)/.test(hostname)) {\n                    break set_domain;\n                }\n\n                newCookie += `;domain=${hostname}`;\n            }\n\n            document.cookie = newCookie;\n        };\n\n        setColorSchemeCookie($clientSideIsDark.current);\n\n        $clientSideIsDark.subscribe(setColorSchemeCookie);\n    }\n\n    {\n        const setRootColorScheme = (isDark: boolean) => {\n            const nonce = window.ssrNonce;\n            if (doCheckNonce && !nonce) {\n                return;\n            }\n            document.getElementById(rootColorSchemeStyleTagId)?.remove();\n\n            const element = document.createElement(\"style\");\n\n            element.id = rootColorSchemeStyleTagId;\n\n            if (nonce) {\n                element.setAttribute(\"nonce\", nonce);\n            }\n\n            element.innerHTML = sanitizer.createHTML(\n                `:root { color-scheme: ${isDark ? \"dark\" : \"light\"}; }`\n            );\n\n            document.head.appendChild(element);\n        };\n\n        setRootColorScheme($clientSideIsDark.current);\n\n        $clientSideIsDark.subscribe(setRootColorScheme);\n    }\n\n    {\n        const setThemeColor = (isDark: boolean) => {\n            const name = \"theme-color\";\n\n            document.querySelector(`meta[name=${name}]`)?.remove();\n\n            const element = document.createElement(\"meta\");\n\n            element.name = name;\n\n            element.content = fr.colors.getHex({\n                isDark\n            }).decisions.background.default.grey.default;\n\n            document.head.appendChild(element);\n        };\n\n        setThemeColor($clientSideIsDark.current);\n\n        $clientSideIsDark.subscribe(setThemeColor);\n    }\n\n    registerEffectAction(() => ($isAfterFirstEffect.current = true));\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}